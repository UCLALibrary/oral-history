<%# OVERRIDE: Blacklight v8.6.0 - dynamic form action based on selected search field %>
<search>
  <% selected_field = params[:search_field].presence || 'full_text' %>

  <%= form_with url: "#", method: :get, local: true, id: 'dynamic-search-form', class: @classes.join(' '), scope: @prefix, role: 'search', **@form_options do |f| %>
    <%= render Blacklight::HiddenSearchStateComponent.new(params: @params) %>

    <% if search_fields.length > 1 %>
      <%= f.label :search_field, scoped_t('search_field.label'), class: 'sr-only visually-hidden' %>
    <% end %>

    <% before_input_groups.each do |input_group| %>
      <%= input_group %>
    <% end %>

    <div class="input-group">
      <%= prepend %>
      <%= f.label @query_param, scoped_t('search.label'), class: 'sr-only visually-hidden' %>
      <%= f.search_field @query_param, value: @q, placeholder: scoped_t('search.placeholder'), class: "search-q q form-control rounded-#{search_fields.length > 1 ? '0' : 'left'}", autofocus: @autofocus %>

      <div class="input-group-addon bg-light">
        <%= f.select :search_field,
        options_for_select([['Full Text', 'full_text'], ['Interview Information', 'interview']], selected_field),
          {},
          class: "custom-select form-select search-field",
          id: "search_field_select" %>
      </div>

      <%= append %>
      <%= search_button || render(Blacklight::SearchButtonComponent.new(id: "#{@prefix}search", text: scoped_t('submit'))) %>
    </div>
  <% end %>

  <% if advanced_search_enabled? %>
    <%= link_to t('blacklight.advanced_search.more_options'), @advanced_search_url, class: 'advanced_search btn btn-secondary' %>
  <% end %>
</search>